.include "macros.inc"

.section .data, "wa"
.balign 0x8
.global __files
__files:
	.incbin "baserom.dol", 0x394898, 0x140

.section .text, "ax"
.global __close_all
__close_all:
/* 800B2928 000AD828  94 21 FF E0 */	stwu r1, -0x20(r1)
/* 800B292C 000AD82C  7C 08 02 A6 */	mflr r0
/* 800B2930 000AD830  90 01 00 24 */	stw r0, 0x24(r1)
/* 800B2934 000AD834  93 E1 00 1C */	stw r31, 0x1c(r1)
/* 800B2938 000AD838  3B E0 00 00 */	li r31, 0
/* 800B293C 000AD83C  93 C1 00 18 */	stw r30, 0x18(r1)
/* 800B2940 000AD840  3B C0 00 03 */	li r30, 3
/* 800B2944 000AD844  93 A1 00 14 */	stw r29, 0x14(r1)
/* 800B2948 000AD848  3F A0 80 3A */	lis r29, __files@ha
/* 800B294C 000AD84C  3B BD 87 98 */	addi r29, r29, __files@l
/* 800B2950 000AD850  48 00 00 58 */	b lbl_800B29A8
lbl_800B2954:
/* 800B2954 000AD854  80 1D 00 04 */	lwz r0, 4(r29)
/* 800B2958 000AD858  54 00 57 7F */	rlwinm. r0, r0, 0xa, 0x1d, 0x1f
/* 800B295C 000AD85C  41 82 00 0C */	beq lbl_800B2968
/* 800B2960 000AD860  7F A3 EB 78 */	mr r3, r29
/* 800B2964 000AD864  48 00 1E 3D */	bl fclose
lbl_800B2968:
/* 800B2968 000AD868  7F A3 EB 78 */	mr r3, r29
/* 800B296C 000AD86C  83 BD 00 4C */	lwz r29, 0x4c(r29)
/* 800B2970 000AD870  88 03 00 0C */	lbz r0, 0xc(r3)
/* 800B2974 000AD874  2C 00 00 00 */	cmpwi r0, 0
/* 800B2978 000AD878  41 82 00 0C */	beq lbl_800B2984
/* 800B297C 000AD87C  4B FF FE 7D */	bl free
/* 800B2980 000AD880  48 00 00 28 */	b lbl_800B29A8
lbl_800B2984:
/* 800B2984 000AD884  80 03 00 04 */	lwz r0, 4(r3)
/* 800B2988 000AD888  53 C0 B1 D2 */	rlwimi r0, r30, 0x16, 7, 9
/* 800B298C 000AD88C  2C 1D 00 00 */	cmpwi r29, 0
/* 800B2990 000AD890  90 03 00 04 */	stw r0, 4(r3)
/* 800B2994 000AD894  41 82 00 14 */	beq lbl_800B29A8
/* 800B2998 000AD898  88 1D 00 0C */	lbz r0, 0xc(r29)
/* 800B299C 000AD89C  2C 00 00 00 */	cmpwi r0, 0
/* 800B29A0 000AD8A0  41 82 00 08 */	beq lbl_800B29A8
/* 800B29A4 000AD8A4  93 E3 00 4C */	stw r31, 0x4c(r3)
lbl_800B29A8:
/* 800B29A8 000AD8A8  2C 1D 00 00 */	cmpwi r29, 0
/* 800B29AC 000AD8AC  40 82 FF A8 */	bne lbl_800B2954
/* 800B29B0 000AD8B0  80 01 00 24 */	lwz r0, 0x24(r1)
/* 800B29B4 000AD8B4  83 E1 00 1C */	lwz r31, 0x1c(r1)
/* 800B29B8 000AD8B8  83 C1 00 18 */	lwz r30, 0x18(r1)
/* 800B29BC 000AD8BC  83 A1 00 14 */	lwz r29, 0x14(r1)
/* 800B29C0 000AD8C0  7C 08 03 A6 */	mtlr r0
/* 800B29C4 000AD8C4  38 21 00 20 */	addi r1, r1, 0x20
/* 800B29C8 000AD8C8  4E 80 00 20 */	blr 

.global __flush_all
__flush_all:
/* 800B29CC 000AD8CC  94 21 FF F0 */	stwu r1, -0x10(r1)
/* 800B29D0 000AD8D0  7C 08 02 A6 */	mflr r0
/* 800B29D4 000AD8D4  90 01 00 14 */	stw r0, 0x14(r1)
/* 800B29D8 000AD8D8  93 E1 00 0C */	stw r31, 0xc(r1)
/* 800B29DC 000AD8DC  3B E0 00 00 */	li r31, 0
/* 800B29E0 000AD8E0  93 C1 00 08 */	stw r30, 8(r1)
/* 800B29E4 000AD8E4  3F C0 80 3A */	lis r30, __files@ha
/* 800B29E8 000AD8E8  3B DE 87 98 */	addi r30, r30, __files@l
/* 800B29EC 000AD8EC  48 00 00 28 */	b lbl_800B2A14
lbl_800B29F0:
/* 800B29F0 000AD8F0  80 1E 00 04 */	lwz r0, 4(r30)
/* 800B29F4 000AD8F4  54 00 57 7F */	rlwinm. r0, r0, 0xa, 0x1d, 0x1f
/* 800B29F8 000AD8F8  41 82 00 18 */	beq lbl_800B2A10
/* 800B29FC 000AD8FC  7F C3 F3 78 */	mr r3, r30
/* 800B2A00 000AD900  48 00 1E 5D */	bl fflush
/* 800B2A04 000AD904  2C 03 00 00 */	cmpwi r3, 0
/* 800B2A08 000AD908  41 82 00 08 */	beq lbl_800B2A10
/* 800B2A0C 000AD90C  3B E0 FF FF */	li r31, -1
lbl_800B2A10:
/* 800B2A10 000AD910  83 DE 00 4C */	lwz r30, 0x4c(r30)
lbl_800B2A14:
/* 800B2A14 000AD914  2C 1E 00 00 */	cmpwi r30, 0
/* 800B2A18 000AD918  40 82 FF D8 */	bne lbl_800B29F0
/* 800B2A1C 000AD91C  7F E3 FB 78 */	mr r3, r31
/* 800B2A20 000AD920  83 E1 00 0C */	lwz r31, 0xc(r1)
/* 800B2A24 000AD924  83 C1 00 08 */	lwz r30, 8(r1)
/* 800B2A28 000AD928  80 01 00 14 */	lwz r0, 0x14(r1)
/* 800B2A2C 000AD92C  7C 08 03 A6 */	mtlr r0
/* 800B2A30 000AD930  38 21 00 10 */	addi r1, r1, 0x10
/* 800B2A34 000AD934  4E 80 00 20 */	blr 
